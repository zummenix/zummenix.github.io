<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#22272e name=theme-color><meta content="mds_store uses a lot of cpu indexing files for Spotlight (most likely just stuck)" name=description><link href="https://zummenix.github.io/style.css?h=2b2e4964a1d2febd8013" rel=stylesheet><link href=https://zummenix.github.io/atom.xml rel=alternate title=Atom type=application/atom+xml><link href=/icons/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=/icons/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/icons/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/icons/site.webmanifest rel=manifest><title>zummenix</title><body><main><ul class=navbar><li><a href=/>Home</a><li><a href=/posts>All Posts</a></ul><h1>Disable Spotlight and life without it</h1><p><span class=tags-list> <svg viewbox="0 0 256 256" class=svg-icon fill=none stroke=currentColor xmlns=http://www.w3.org/2000/svg><path d=M122.7,25.9,42,42,25.9,122.7a8,8,0,0,0,2.2,7.2L132.5,234.3a7.9,7.9,0,0,0,11.3,0l90.5-90.5a7.9,7.9,0,0,0,0-11.3L129.9,28.1A8,8,0,0,0,122.7,25.9Z stroke-width=4% /><circle cx=84 cy=84 fill=currentColor r=12 /></svg>  <a href=/tags/macos>macos</a> · <a href=/tags/bash>bash</a> · <a href=/tags/shorts>shorts</a> </span> <br> <span class=date> <svg viewbox="0 0 256 256" class=svg-icon xmlns=http://www.w3.org/2000/svg><g fill=none stroke=currentColor stroke-width=4%><rect height=190 width=220 x=18 y=40 /><line x1=72 x2=72 y1=18 y2=70 /><line x1=184 x2=184 y1=18 y2=70 /></g><g fill=currentColor stroke=none><circle cx=72 cy=110 r=12 /><circle cx=128 cy=110 r=12 /><circle cx=183 cy=110 r=12 /><circle cx=72 cy=170 r=12 /><circle cx=128 cy=170 r=12 /></g></svg>  December 2</span><p>I've recently noticed that the <code>mds_stores</code> process on my Mac is consuming a significant amount of CPU power. Again.<p><code>mds_stores</code> is a background process that indexes files for faster searching in Spotlight. Seasoned macOS users very likely know about it and know that wise decision would be to disable some of search areas by changing Spotlight settings. This is me too. I have only Applications, Calculator and System Settings items enabled and still <code>mds_stores</code> is the first in the list of cpu consumers in Activity Monitor. I'm not sure if it happened after updating macOS or earlier for some other reason.<p>Something needs to be done. This is last straw :)<p>I'm disabling Spotlight completely:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>sudo</span><span> mdutil</span><span style=color:#bf616a> -ai</span><span> off
</span></code></pre><p>It spat out the following:<pre style=color:#c0c5ce;background-color:#2b303b><code><span>/:
</span><span>2024-11-22 00:21:40.119 mdutil[25437:982881] mdutil disabling Spotlight: / -> kMDConfigSearchLevelFSSearchOnly
</span><span>        Indexing disabled.
</span><span>/System/Volumes/Data:
</span><span>2024-11-22 00:21:40.144 mdutil[25437:982881] mdutil disabling Spotlight: /System/Volumes/Data -> kMDConfigSearchLevelFSSearchOnly
</span><span>Error: unable to perform operation.  (-1)
</span><span>        Error: unknown indexing state.
</span><span>/System/Volumes/Preboot:
</span><span>Error: invalid operation.
</span><span>        Error: unknown indexing state.
</span></code></pre><p>Maybe these errors are somehow related to the problem. After running the command second time it reported that indexing is disabled without any errors.<p>It's sad to loose Spotlight functionality. Brief research revealed existence of similar apps such as <a href=https://www.alfredapp.com>Alfred</a> or <a href=https://www.raycast.com>Raycast</a>. I haven't tried them because I probably can't use most of their features. Eventually I figured that I can write simple alternatives for my needs myself. That I did.<p>The main feature of Spotlight that I miss the most is fast opening any app by typing in Spotlight search field. The solution would be to search the <code>*.app</code> in special directories. Filter/search could be done using <a href=https://junegunn.github.io/fzf/><code>fzf</code></a> (or similar tools). And opening an app will be done using native Apple script. Here is the first working script in bash:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#65737e>#!/usr/bin/env bash
</span><span>
</span><span style=color:#b48ead>function </span><span style=color:#8fa1b3>list_apps </span><span>{
</span><span>    </span><span style=color:#bf616a>find </span><span>"$</span><span style=color:#bf616a>1</span><span>"</span><span style=color:#bf616a> -type</span><span> d</span><span style=color:#bf616a> -maxdepth</span><span> 1</span><span style=color:#bf616a> -name </span><span>'</span><span style=color:#a3be8c>*.app</span><span>' | </span><span style=color:#bf616a>sed </span><span>'</span><span style=color:#a3be8c>s#.*/##</span><span>' | </span><span style=color:#bf616a>sed </span><span>'</span><span style=color:#a3be8c>s/.app$//</span><span>'
</span><span>}
</span><span>
</span><span style=color:#bf616a>paste -d</span><span>'</span><span style=color:#a3be8c>\n</span><span>' &lt;(</span><span style=color:#bf616a>list_apps</span><span> /Applications) &lt;(</span><span style=color:#bf616a>list_apps</span><span> /System/Applications) &lt;(</span><span style=color:#bf616a>list_apps</span><span> /System/Applications/Utilities) | \
</span><span>    </span><span style=color:#bf616a>xargs -I</span><span>{} echo "</span><span style=color:#a3be8c>{}</span><span>" | \
</span><span>    </span><span style=color:#bf616a>sort -if </span><span>| \
</span><span>    </span><span style=color:#bf616a>fzf --header </span><span>"</span><span style=color:#a3be8c>Select app to open</span><span>" | \
</span><span>    </span><span style=color:#bf616a>xargs -I</span><span>{} osascript</span><span style=color:#bf616a> -e </span><span>"</span><span style=color:#a3be8c>tell application </span><span style=color:#96b5b4>\"</span><span style=color:#a3be8c>{}</span><span style=color:#96b5b4>\"</span><span style=color:#a3be8c> to activate</span><span>"
</span></code></pre><p>Here is how it looks:<div><script async id=asciicast-693053 src=https://asciinema.org/a/693053.js></script></div><p>I'll probably update this script in the future if I find any bugs or find myself missing some features. You can always check my dotfiles for that <a href=https://github.com/zummenix/dotfiles/tree/master/scripts>here</a>.<p>For now I'm happy with this simple solution, knowing that <code>mds_stores</code> won't use any cpu to no purpose.</main><footer><p>© 2025 Aleksey Kuznetsov. All rights reserved.<p>Content and media are licensed under the <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0</a>. Code samples are under the <a href=/licenses/unlicense.txt>Unlicense</a>.</footer>